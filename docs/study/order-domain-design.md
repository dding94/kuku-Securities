# ì£¼ë¬¸ ë„ë©”ì¸ ì„¤ê³„ - ì™œ ì´ë ‡ê²Œ êµ¬í˜„í–ˆëŠ”ê°€?

> ğŸ“š ì´ ë¬¸ì„œëŠ” ì£¼ë¬¸ ì‹œìŠ¤í…œ ë„ë©”ì¸ ì„¤ê³„ì˜ "ì™œ?"ì— ì§‘ì¤‘í•©ë‹ˆë‹¤.
> ë©´ì ‘ ì¤€ë¹„ì™€ ê°œë… ì´í•´ë¥¼ ìœ„í•´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ëª©ì°¨

1. [ì‹¤ì œ ì£¼ì‹ ê±°ë˜ íë¦„ ì´í•´í•˜ê¸°](#1-ì‹¤ì œ-ì£¼ì‹-ê±°ë˜-íë¦„-ì´í•´í•˜ê¸°)
2. [ìƒíƒœ ë¨¸ì‹ (State Machine)ì´ë€?](#2-ìƒíƒœ-ë¨¸ì‹ state-machineì´ë€)
3. [ê° ìƒíƒœê°€ ì™œ í•„ìš”í•œê°€?](#3-ê°-ìƒíƒœê°€-ì™œ-í•„ìš”í•œê°€)
4. [ì™œ ë¶ˆë³€ ê°ì²´(Immutable Object)ì¸ê°€?](#4-ì™œ-ë¶ˆë³€-ê°ì²´immutable-objectì¸ê°€)
5. [ì™œ State Pattern ëŒ€ì‹  Enum + Domain Method?](#5-ì™œ-state-pattern-ëŒ€ì‹ -enum--domain-method)
6. [Self-Validation: ì™œ ìƒì„±ìì—ì„œ ê²€ì¦í•˜ëŠ”ê°€?](#6-self-validation-ì™œ-ìƒì„±ìì—ì„œ-ê²€ì¦í•˜ëŠ”ê°€)
7. [ê¸ˆìœµ ë„ë©”ì¸ íŠ¹ìˆ˜ì„±](#7-ê¸ˆìœµ-ë„ë©”ì¸-íŠ¹ìˆ˜ì„±)
8. [ë©´ì ‘ ì˜ˆìƒ ì§ˆë¬¸ & ë‹µë³€](#8-ë©´ì ‘-ì˜ˆìƒ-ì§ˆë¬¸--ë‹µë³€)
9. [í•µì‹¬ í‚¤ì›Œë“œ ì •ë¦¬](#9-í•µì‹¬-í‚¤ì›Œë“œ-ì •ë¦¬)

---

## 1. ì‹¤ì œ ì£¼ì‹ ê±°ë˜ íë¦„ ì´í•´í•˜ê¸°

### ì¹´í˜ ì£¼ë¬¸ê³¼ ë¹„êµí•˜ê¸°

ì£¼ì‹ ì£¼ë¬¸ì€ ì¹´í˜ì—ì„œ ì»¤í”¼ ì£¼ë¬¸í•˜ëŠ” ê²ƒê³¼ ë¹„ìŠ·í•©ë‹ˆë‹¤.

| ë‹¨ê³„ | ì¹´í˜ ì£¼ë¬¸ | ì£¼ì‹ ì£¼ë¬¸ | ìƒíƒœ |
|------|----------|----------|------|
| 1 | í‚¤ì˜¤ìŠ¤í¬ì—ì„œ ì£¼ë¬¸ | ì•±ì—ì„œ ë§¤ìˆ˜ ë²„íŠ¼ í´ë¦­ | `CREATED` |
| 2 | "ì¬ë£Œ ìˆìŒ" í™•ì¸ | ì˜ˆìˆ˜ê¸ˆ ì¶©ë¶„í•œì§€ í™•ì¸ | `VALIDATED` |
| 3 | ì»¤í”¼ ì™„ì„± | ì²´ê²° ì™„ë£Œ | `FILLED` |
| - | "ì¬ë£Œ ì—†ìŒ" | ì˜ˆìˆ˜ê¸ˆ ë¶€ì¡± | `REJECTED` |
| - | ê³ ê°ì´ ì·¨ì†Œ | ì‚¬ìš©ìê°€ ì·¨ì†Œ | `CANCELLED` |

### ì™œ ë°”ë¡œ ì²´ê²°í•˜ì§€ ì•Šê³  ì—¬ëŸ¬ ë‹¨ê³„ê°€ í•„ìš”í•œê°€?

**ì¹´í˜**
- ì£¼ë¬¸ â†’ ê²°ì œ â†’ ì œì¡° â†’ ìˆ˜ë ¹
- ê²°ì œ ì‹¤íŒ¨í•˜ë©´? ì£¼ë¬¸ ì·¨ì†Œ
- ì¬ë£Œ ì—†ìœ¼ë©´? ì£¼ë¬¸ ê±°ë¶€

**ì£¼ì‹**
- ì£¼ë¬¸ ì ‘ìˆ˜ â†’ ì˜ˆìˆ˜ê¸ˆ í™•ì¸ â†’ ê±°ë˜ì†Œ ì „ì†¡ â†’ ì²´ê²° ëŒ€ê¸° â†’ ê²°ê³¼ ìˆ˜ì‹ 
- ì˜ˆìˆ˜ê¸ˆ ë¶€ì¡±í•˜ë©´? ì£¼ë¬¸ ê±°ë¶€
- ì²´ê²° ì‹¤íŒ¨í•˜ë©´? ì£¼ë¬¸ ê±°ë¶€

> ğŸ’¡ **í•µì‹¬ ì¸ì‚¬ì´íŠ¸**: ì‹¤ì œ ì„¸ê³„ì˜ ê±°ë˜ëŠ” "í•œ ìˆœê°„"ì— ëë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
> ì—¬ëŸ¬ ë‹¨ê³„ë¥¼ ê±°ì¹˜ë©°, ê° ë‹¨ê³„ì—ì„œ ì‹¤íŒ¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
> ì´ë¥¼ ì½”ë“œë¡œ ëª…ì‹œì ìœ¼ë¡œ í‘œí˜„í•œ ê²ƒì´ **ìƒíƒœ ë¨¸ì‹ **ì…ë‹ˆë‹¤.

---

## 2. ìƒíƒœ ë¨¸ì‹ (State Machine)ì´ë€?

### ì •ì˜

> **ìƒíƒœ ë¨¸ì‹ **: ìœ í•œí•œ ê°œìˆ˜ì˜ ìƒíƒœ(State)ì™€ ìƒíƒœ ê°„ ì „ì´(Transition) ê·œì¹™ì„ ì •ì˜í•œ ëª¨ë¸

### ì™œ ìƒíƒœ ë¨¸ì‹ ì„ ì‚¬ìš©í•˜ëŠ”ê°€?

#### âŒ ìƒíƒœ ë¨¸ì‹  ì—†ëŠ” ì½”ë“œ

```java
public class Order {
    private String status;
    
    public void process() {
        if (status.equals("created")) {
            // ì˜ˆìˆ˜ê¸ˆ í™•ì¸
            if (hasEnoughBalance()) {
                status = "validated";
            } else {
                status = "rejected";
            }
        } else if (status.equals("validated")) {
            // ì²´ê²° ì‹œë„
            if (executeOrder()) {
                status = "filled";
            } else {
                status = "rejected";
            }
        }
        // ... ì ì  ë³µì¡í•´ì§
    }
}
```

**ë¬¸ì œì :**
- ë¬¸ìì—´ ë¹„êµ â†’ ì˜¤íƒ€ ìœ„í—˜
- ì „ì´ ê·œì¹™ì´ ì½”ë“œì— í©ì–´ì ¸ ìˆìŒ
- ì˜ëª»ëœ ì „ì´ ë°©ì§€ ì–´ë ¤ì›€ (ì˜ˆ: FILLED â†’ CREATED)

#### âœ… ìƒíƒœ ë¨¸ì‹  ì ìš© ì½”ë“œ

```java
public enum OrderStatus {
    CREATED, VALIDATED, FILLED, REJECTED, CANCELLED;
    
    public boolean canTransitionTo(OrderStatus target) {
        return switch (this) {
            case CREATED -> target == VALIDATED || target == REJECTED;
            case VALIDATED -> target == FILLED || target == REJECTED || target == CANCELLED;
            case FILLED, REJECTED, CANCELLED -> false;  // ì¢…ë£Œ ìƒíƒœ
        };
    }
}
```

**ì¥ì :**
- íƒ€ì… ì•ˆì „ (ì˜¤íƒ€ = ì»´íŒŒì¼ ì—ëŸ¬)
- ì „ì´ ê·œì¹™ì´ í•œ ê³³ì— ì§‘ì¤‘
- ì˜ëª»ëœ ì „ì´ëŠ” ì˜ˆì™¸ ë°œìƒ

---

## 3. ê° ìƒíƒœê°€ ì™œ í•„ìš”í•œê°€?

### CREATED (ì£¼ë¬¸ ìƒì„±ë¨)

```
ì‚¬ìš©ì: "ì‚¼ì„±ì „ì 10ì£¼ ë§¤ìˆ˜í•´ì¤˜"
ì‹œìŠ¤í…œ: "ì•Œê² ìŠµë‹ˆë‹¤. ì£¼ë¬¸ ì ‘ìˆ˜í–ˆì–´ìš”." â†’ CREATED
```

**ì™œ í•„ìš”í•œê°€?**
- ì£¼ë¬¸ì´ "ì ‘ìˆ˜"ë˜ì—ˆìŒì„ ê¸°ë¡
- ì•„ì§ ì•„ë¬´ê²ƒë„ ê²€ì¦ë˜ì§€ ì•ŠìŒ
- ê²€ì¦ ë¡œì§ì´ ë¹„ë™ê¸°/ë³µì¡í•  ë•Œ ì¶”ì  ê°€ëŠ¥

### VALIDATED (ê²€ì¦ ì™„ë£Œ)

```
ì‹œìŠ¤í…œ: "ì˜ˆìˆ˜ê¸ˆ í™•ì¸ ì™„ë£Œ, ì£¼ë¬¸ ê°€ëŠ¥í•©ë‹ˆë‹¤." â†’ VALIDATED
```

**ì™œ í•„ìš”í•œê°€?**
- ê²€ì¦ í†µê³¼ = ê±°ë˜ì†Œì— ë³´ë‚¼ ì¤€ë¹„ ì™„ë£Œ
- ì‚¬ìš©ìê°€ "ë§ˆìŒ ë°”ê¿”ì„œ ì·¨ì†Œ"í•  ìˆ˜ ìˆëŠ” ë§ˆì§€ë§‰ ê¸°íšŒ
- ì²´ê²° ì‹¤íŒ¨í•´ë„ "ê²€ì¦ê¹Œì§€ëŠ” í†µê³¼í–ˆë‹¤"ëŠ” ê¸°ë¡

**ì™œ CREATEDì—ì„œ ë°”ë¡œ FILLEDë¡œ ì•ˆ ê°€ëŠ”ê°€?**

```
ì˜ëª»ëœ ì‹œë‚˜ë¦¬ì˜¤:
1. CREATED (ì˜ˆìˆ˜ê¸ˆ 10ë§Œì›)
2. ë°”ë¡œ FILLED (70ë§Œì›ì§œë¦¬ ì£¼ì‹ 10ì£¼ ë§¤ìˆ˜)
â†’ ì˜ˆìˆ˜ê¸ˆ 60ë§Œì› ë¶€ì¡±ì¸ë° ì²´ê²°ë¨!

ì˜¬ë°”ë¥¸ ì‹œë‚˜ë¦¬ì˜¤:
1. CREATED
2. ì˜ˆìˆ˜ê¸ˆ í™•ì¸ â†’ ë¶€ì¡± â†’ REJECTED
```

### FILLED (ì²´ê²° ì™„ë£Œ)

```
ì‹œìŠ¤í…œ: "ì‚¼ì„±ì „ì 10ì£¼, 70,000ì›ì— ì²´ê²° ì™„ë£Œ!" â†’ FILLED
```

**ì™œ í•„ìš”í•œê°€?**
- ê±°ë˜ ì™„ë£Œì˜ ìµœì¢… ìƒíƒœ
- `executedPrice`, `executedQuantity` ê¸°ë¡
- ë˜ëŒë¦´ ìˆ˜ ì—†ìŒ (ì¢…ë£Œ ìƒíƒœ)

**ì™œ executedPriceê°€ ë³„ë„ë¡œ í•„ìš”í•œê°€?**

```java
// ì‹œì¥ê°€ ì£¼ë¬¸ ì‹œ
Order order = Order.create(
    accountId, "005930", quantity, 
    OrderSide.BUY, OrderType.MARKET, 
    null,  // priceê°€ null! (ì‹œì¥ê°€ë¼ì„œ)
    ...
);

// ì²´ê²° ì‹œ
Order filled = order.fill(
    new BigDecimal("70100"),  // ì‹¤ì œ ì²´ê²°ê°€
    ...
);
```

> ğŸ’¡ **ì‹œì¥ê°€ ì£¼ë¬¸**: "ì§€ê¸ˆ ì‹œì¥ì—ì„œ í˜•ì„±ëœ ê°€ê²©ìœ¼ë¡œ ì‚¬ì¤˜"
> ì£¼ë¬¸ ì‹œì ê³¼ ì²´ê²° ì‹œì  ì‚¬ì´ì— ê°€ê²©ì´ ë³€í•  ìˆ˜ ìˆìŒ!

### REJECTED (ê±°ë¶€ë¨)

```
ì‹œìŠ¤í…œ: "ì˜ˆìˆ˜ê¸ˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤." â†’ REJECTED (INSUFFICIENT_BALANCE)
```

**ê±°ë¶€ ì‚¬ìœ  (RejectionReason):**

| ì‚¬ìœ  | ì–¸ì œ ë°œìƒ? | ì˜ë¯¸ |
|------|----------|------|
| `INSUFFICIENT_BALANCE` | ë§¤ìˆ˜ ì‹œ | ì˜ˆìˆ˜ê¸ˆì´ ì£¼ë¬¸ ê¸ˆì•¡ë³´ë‹¤ ì ìŒ |
| `INSUFFICIENT_QUANTITY` | ë§¤ë„ ì‹œ | íŒ”ë ¤ëŠ” ìˆ˜ëŸ‰ë³´ë‹¤ ë³´ìœ ëŸ‰ì´ ì ìŒ |
| `MARKET_CLOSED` | ì¥ ë§ˆê° í›„ | 09:00~15:30 ì™¸ ì‹œê°„ |

**ì™œ ì‚¬ìœ ê°€ í•„ìš”í•œê°€?**
- ì‚¬ìš©ìì—ê²Œ "ì™œ ì•ˆ ëëŠ”ì§€" ì•Œë ¤ì¤˜ì•¼ í•¨
- ê³ ê°ì„¼í„° ë¬¸ì˜ ëŒ€ì‘
- ê·œì œ ê°ì‚¬ ì‹œ ê·¼ê±° ìë£Œ

### CANCELLED (ì·¨ì†Œë¨)

```
ì‚¬ìš©ì: "ì•„, ì ê¹ ì·¨ì†Œí• ê²Œ"
ì‹œìŠ¤í…œ: "ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤." â†’ CANCELLED
```

**ì™œ VALIDATEDì—ì„œë§Œ ì·¨ì†Œ ê°€ëŠ¥í•œê°€?**

| ìƒíƒœ | ì·¨ì†Œ ê°€ëŠ¥? | ì´ìœ  |
|------|----------|------|
| CREATED | âŒ | ê²€ì¦ë„ ì•ˆ ëë‚¬ìŒ, ì·¨ì†Œí•  ê²Œ ì—†ìŒ |
| VALIDATED | âœ… | ê²€ì¦ ì™„ë£Œ, ì•„ì§ ì²´ê²° ì „ |
| FILLED | âŒ | ì´ë¯¸ ê±°ë˜ ì™„ë£Œ, ë˜ëŒë¦´ ìˆ˜ ì—†ìŒ |
| REJECTED | âŒ | ì´ë¯¸ ê±°ë¶€ë¨, ì·¨ì†Œí•  ê²Œ ì—†ìŒ |

---

## 4. ì™œ ë¶ˆë³€ ê°ì²´(Immutable Object)ì¸ê°€?

### ë³€ê²½ ê°€ëŠ¥í•œ ê°ì²´ (Mutable)

```java
Order order = new Order();
order.setStatus(OrderStatus.CREATED);
// ... ì‹œê°„ì´ íë¦„ ...
order.setStatus(OrderStatus.VALIDATED);
// ... ì‹œê°„ì´ íë¦„ ...
order.setStatus(OrderStatus.FILLED);
```

**ë¬¸ì œì :**
- "ì–¸ì œ ìƒíƒœê°€ ë°”ë€Œì—ˆëŠ”ì§€" ì¶”ì  ë¶ˆê°€
- ë©€í‹°ìŠ¤ë ˆë“œì—ì„œ ë™ì‹œì— ìˆ˜ì •í•˜ë©´? ğŸ’¥
- ì´ì „ ìƒíƒœ ê¸°ë¡ì´ ì‚¬ë¼ì§

### ë¶ˆë³€ ê°ì²´ (Immutable)

```java
Order created = Order.create(...);  // CREATED
Order validated = created.validate(now);  // VALIDATED (ìƒˆ ê°ì²´)
Order filled = validated.fill(price, qty, now);  // FILLED (ìƒˆ ê°ì²´)
```

**ì¥ì :**

| ê´€ì  | íš¨ê³¼ |
|------|------|
| **ì¶”ì ì„±** | ê° ìƒíƒœê°€ ë³„ë„ ê°ì²´ë¡œ ì¡´ì¬, ë¡œê·¸ ê°€ëŠ¥ |
| **Thread-Safety** | ê°ì²´ê°€ ë³€í•˜ì§€ ì•Šìœ¼ë‹ˆ ë™ê¸°í™” ë¶ˆí•„ìš” |
| **ë””ë²„ê¹…** | ì–´ëŠ ì‹œì ì˜ ìƒíƒœë“  ì¬í˜„ ê°€ëŠ¥ |
| **ê¸ˆìœµ ê·œì œ** | Audit Trail (ê°ì‚¬ ì¶”ì ) ìš”êµ¬ì‚¬í•­ ì¶©ì¡± |

### ê¸ˆìœµ ì‹œìŠ¤í…œì—ì„œ ë¶ˆë³€ì„±ì´ ì¤‘ìš”í•œ ì´ìœ 

```
ê·œì œ ê°ì‚¬ê´€: "2025ë…„ 1ì›” 5ì¼ ì˜¤í›„ 3ì‹œì— ì´ ì£¼ë¬¸ì˜ ìƒíƒœê°€ ë­ì˜€ì£ ?"
ê°œë°œì (Mutable): "ìŒ... í˜„ì¬ ìƒíƒœëŠ” ì•„ëŠ”ë°, ê·¸ë•Œ ìƒíƒœëŠ”..."
ê°œë°œì (Immutable): "VALIDATEDì˜€ìŠµë‹ˆë‹¤. ë¡œê·¸ì— ë‹¤ ìˆì–´ìš”."
```

---

## 5. ì™œ State Pattern ëŒ€ì‹  Enum + Domain Method?

### State Pattern (GoF) ë°©ì‹

```java
interface OrderState {
    OrderState validate(Order order);
    OrderState reject(Order order, RejectionReason reason);
    OrderState fill(Order order, BigDecimal price, BigDecimal qty);
    OrderState cancel(Order order);
}

class CreatedState implements OrderState {
    @Override
    public OrderState validate(Order order) {
        // ê²€ì¦ ë¡œì§
        return new ValidatedState();
    }
    // ... ë‚˜ë¨¸ì§€ ë©”ì„œë“œ
}

class ValidatedState implements OrderState { ... }
class FilledState implements OrderState { ... }
class RejectedState implements OrderState { ... }
class CancelledState implements OrderState { ... }
```

**ì¥ì :**
- OCP (Open/Closed Principle) ì¤€ìˆ˜
- ìƒíƒœë³„ ë³µì¡í•œ ë¡œì§ ë¶„ë¦¬

**ë‹¨ì :**
- 5ê°œ ìƒíƒœ = 5ê°œ í´ë˜ìŠ¤ í•„ìš”
- ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ì½”ë“œ ë§ìŒ
- í˜„ì¬ ë¡œì§ ëŒ€ë¹„ ê³¼ì‰ ì„¤ê³„

### Enum + Domain Method ë°©ì‹ (í˜„ì¬ ì„ íƒ)

```java
public Order validate(Instant now) {
    if (this.status != OrderStatus.CREATED) {
        throw new InvalidOrderStateException(
            "Only CREATED orders can be validated. Current: " + this.status
        );
    }
    return withStatusAndTime(OrderStatus.VALIDATED, now);
}
```

**ì¥ì :**
- ì½”ë“œê°€ ë‹¨ìˆœí•˜ê³  ì§ê´€ì 
- í´ë˜ìŠ¤ ìˆ˜ ìµœì†Œí™”
- switch expressionìœ¼ë¡œ íƒ€ì… ì•ˆì „

### ì™œ ì´ ë°©ì‹ì„ ì„ íƒí–ˆëŠ”ê°€?

**YAGNI ì›ì¹™ (You Aren't Gonna Need It)**

> "í•„ìš”í•  ë•Œ ë§Œë“¤ì–´ë¼. ë¯¸ë¦¬ ë§Œë“¤ì§€ ë§ˆë¼."

í˜„ì¬ ìš”êµ¬ì‚¬í•­:
- ìƒíƒœ 5ê°œ
- ìƒíƒœë³„ ë¡œì§ì´ ë‹¨ìˆœ (1~5ì¤„)
- ë³µì¡í•œ ìƒíƒœ ì˜ì¡´ ë¡œì§ ì—†ìŒ

â†’ State Patternì€ **ê³¼ì‰ ì„¤ê³„**

### í™•ì¥ ì•ˆì „ì„±: switch expression

```java
public boolean canTransitionTo(OrderStatus target) {
    return switch (this) {
        case CREATED -> target == VALIDATED || target == REJECTED;
        case VALIDATED -> target == FILLED || target == REJECTED || target == CANCELLED;
        case FILLED, REJECTED, CANCELLED -> false;
        // ë§Œì•½ PARTIALLY_FILLED ì¶”ê°€í•˜ë©´? ì—¬ê¸°ì„œ ì»´íŒŒì¼ ì—ëŸ¬!
    };
}
```

> ğŸ’¡ **ë©´ì ‘ í¬ì¸íŠ¸**: "switch expressionì€ ëª¨ë“  ì¼€ì´ìŠ¤ë¥¼ ê°•ì œí•©ë‹ˆë‹¤. ìƒˆ ìƒíƒœ ì¶”ê°€ ì‹œ ì»´íŒŒì¼ëŸ¬ê°€ ëˆ„ë½ì„ ì¡ì•„ì¤ë‹ˆë‹¤."

---

## 6. Self-Validation: ì™œ ìƒì„±ìì—ì„œ ê²€ì¦í•˜ëŠ”ê°€?

### Fail-Fast ì›ì¹™

```java
public Order(...) {
    if (accountId == null) {
        throw new IllegalArgumentException("AccountId cannot be null");
    }
    if (quantity == null || quantity.compareTo(BigDecimal.ZERO) <= 0) {
        throw new IllegalArgumentException("Quantity must be greater than zero");
    }
    // ...
}
```

**ì™œ ìƒì„±ìì—ì„œ ê²€ì¦í•˜ëŠ”ê°€?**

| ì‹œì  | ì¥ì  | ë‹¨ì  |
|------|------|------|
| **ìƒì„±ì (Fail-Fast)** | ì˜ëª»ëœ ê°ì²´ê°€ ì¡´ì¬í•  ìˆ˜ ì—†ìŒ | ìƒì„±ìê°€ ë³µì¡í•´ì§ |
| ë³„ë„ validate() ë©”ì„œë“œ | ìƒì„±ì ë‹¨ìˆœ | ê²€ì¦ ì•ˆ í•œ ê°ì²´ ì¡´ì¬ ê°€ëŠ¥ |
| ì„œë¹„ìŠ¤ ë ˆì´ì–´ | ë„ë©”ì¸ ë‹¨ìˆœ | ë„ë©”ì¸ ë¶ˆë³€ì‹ ê¹¨ì§ˆ ìˆ˜ ìˆìŒ |

### Always Valid Domain Model

> "ë„ë©”ì¸ ê°ì²´ëŠ” í•­ìƒ ìœ íš¨í•œ ìƒíƒœë§Œ ì¡´ì¬í•´ì•¼ í•œë‹¤"

```java
// âœ… ì´ëŸ° ê°ì²´ë§Œ ì¡´ì¬ ê°€ëŠ¥
Order validOrder = new Order(100L, "005930", new BigDecimal("10"), ...);

// âŒ ì´ëŸ° ê°ì²´ëŠ” ìƒì„± ìì²´ê°€ ë¶ˆê°€ëŠ¥
Order invalidOrder = new Order(null, "", BigDecimal.ZERO, ...);
// â†’ IllegalArgumentException ë°œìƒ!
```

---

## 7. ê¸ˆìœµ ë„ë©”ì¸ íŠ¹ìˆ˜ì„±

### ì˜ˆìˆ˜ê¸ˆ (é å—é‡‘, Deposit)

> ì¦ê¶Œì‚¬ì— ë¯¸ë¦¬ ì…ê¸ˆí•´ë‘” ëˆ. ì£¼ì‹ì„ ë§¤ìˆ˜í•  ë•Œ ì‚¬ìš©ë¨.

```
ì˜ˆìˆ˜ê¸ˆ 100ë§Œì› ìˆìŒ
ì‚¼ì„±ì „ì 70,000ì› Ã— 10ì£¼ = 70ë§Œì› í•„ìš”
â†’ ë§¤ìˆ˜ ê°€ëŠ¥ (ì˜ˆìˆ˜ê¸ˆ ì”ì•¡ 30ë§Œì›)
```

### ì¥ ìš´ì˜ ì‹œê°„

```
ê°œì¥: 09:00 KST
íì¥: 15:30 KST
íœ´ì¥ì¼: í† , ì¼, ê³µíœ´ì¼
```

**ì™œ ì¥ ì‹œê°„ì„ ì²´í¬í•˜ëŠ”ê°€?**
- ì¥ ë§ˆê° í›„ ì£¼ë¬¸ì€ ê±°ë˜ì†Œê°€ ë°›ì§€ ì•ŠìŒ
- ì‚¬ì „ ì°¨ë‹¨í•´ì„œ ë¶ˆí•„ìš”í•œ ê±°ë˜ì†Œ ìš”ì²­ ë°©ì§€

### ì‹œì¥ê°€ vs ì§€ì •ê°€

| ì£¼ë¬¸ ìœ í˜• | ì„¤ëª… | price í•„ë“œ |
|----------|------|-----------|
| ì‹œì¥ê°€ (MARKET) | "ì§€ê¸ˆ ê°€ê²©ì— ë°”ë¡œ ì‚¬ì¤˜" | null |
| ì§€ì •ê°€ (LIMIT) | "70,000ì› ì´í•˜ì¼ ë•Œë§Œ ì‚¬ì¤˜" | 70000 |

í˜„ì¬ëŠ” ì‹œì¥ê°€ë§Œ ì§€ì› (Week 7ì—ì„œ ì§€ì •ê°€ í™•ì¥ ì˜ˆì •)

### ìŠ¬ë¦¬í”¼ì§€ (Slippage)

> ì£¼ë¬¸ ì‹œì ê³¼ ì²´ê²° ì‹œì ì˜ ê°€ê²© ì°¨ì´

```
ì£¼ë¬¸ ì‹œ: ì‚¼ì„±ì „ì 70,000ì›
ì²´ê²° ì‹œ: ì‚¼ì„±ì „ì 70,500ì› (0.7% ìƒìŠ¹)
â†’ ìŠ¬ë¦¬í”¼ì§€ 500ì›
```

ìŠ¬ë¦¬í”¼ì§€ê°€ ë„ˆë¬´ í¬ë©´ ì‚¬ìš©ìì—ê²Œ ë¶ˆë¦¬ â†’ Week 7ì—ì„œ `PRICE_SLIPPAGE` ê±°ë¶€ ì‚¬ìœ  êµ¬í˜„ ì˜ˆì •

---

## 8. ë©´ì ‘ ì˜ˆìƒ ì§ˆë¬¸ & ë‹µë³€

### Q1: "ì™œ ìƒíƒœ ë¨¸ì‹ ì„ ì‚¬ìš©í–ˆë‚˜ìš”?"

> "ì‹¤ì œ ì£¼ì‹ ê±°ë˜ëŠ” ë¹„ë™ê¸°ì ì´ê³  ì—¬ëŸ¬ ë‹¨ê³„ë¥¼ ê±°ì¹©ë‹ˆë‹¤. ì£¼ë¬¸ ì ‘ìˆ˜, ì˜ˆìˆ˜ê¸ˆ í™•ì¸, ê±°ë˜ì†Œ ì „ì†¡, ì²´ê²° ëŒ€ê¸° ë“± ê° ë‹¨ê³„ë¥¼ ëª…ì‹œì ì¸ ìƒíƒœë¡œ ê´€ë¦¬í•´ì•¼ **ì¥ì•  ë³µêµ¬, ê°ì‚¬ ì¶”ì , ë™ì‹œì„± ì œì–´**ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì‹œìŠ¤í…œ ì¥ì•  ì‹œ 'ì–´ë””ê¹Œì§€ ì§„í–‰ëëŠ”ì§€'ë¥¼ ìƒíƒœë¡œ ì¦‰ì‹œ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."

### Q2: "ì™œ ë¶ˆë³€ ê°ì²´ë¡œ ì„¤ê³„í–ˆë‚˜ìš”?"

> "ê¸ˆìœµ ì‹œìŠ¤í…œì€ ëª¨ë“  ìƒíƒœ ë³€í™”ë¥¼ ì¶”ì í•´ì•¼ í•©ë‹ˆë‹¤. ê·œì œ ê°ì‚¬ ì‹œ 'ì–¸ì œ ì–´ë–¤ ìƒíƒœì˜€ëŠ”ì§€' ì¦ëª…ì´ í•„ìš”í•©ë‹ˆë‹¤. ë¶ˆë³€ ê°ì²´ëŠ” ìƒíƒœ ë³€ê²½ ì‹œ ìƒˆ ê°ì²´ë¥¼ ìƒì„±í•˜ë¯€ë¡œ **Audit Trail**ì´ ìì—°ìŠ¤ëŸ½ê²Œ êµ¬í˜„ë©ë‹ˆë‹¤. ë˜í•œ ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ë™ê¸°í™” ì—†ì´ ì•ˆì „í•©ë‹ˆë‹¤."

### Q3: "State Pattern ëŒ€ì‹  Enumì„ ì„ íƒí•œ ì´ìœ ëŠ”?"

> "í˜„ì¬ ìƒíƒœê°€ 5ê°œë¡œ ë‹¨ìˆœí•˜ê³ , ìƒíƒœë³„ ë¡œì§ë„ ë³µì¡í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. YAGNI ì›ì¹™ì— ë”°ë¼ ê³¼ë„í•œ ì¶”ìƒí™”ë¥¼ í”¼í–ˆìŠµë‹ˆë‹¤. ëŒ€ì‹  Java 14+ì˜ switch expressionì„ ì‚¬ìš©í•´ ìƒˆ ìƒíƒœ ì¶”ê°€ ì‹œ **ì»´íŒŒì¼ ì—ëŸ¬**ë¡œ ëˆ„ë½ì„ ë°©ì§€í•©ë‹ˆë‹¤. ìƒíƒœê°€ 10ê°œ ì´ìƒì´ê±°ë‚˜ ìƒíƒœë³„ ë³µì¡í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ìƒê¸°ë©´ State Patternìœ¼ë¡œ ë¦¬íŒ©í† ë§í•  ê³„íšì…ë‹ˆë‹¤."

### Q4: "CREATEDì—ì„œ ë°”ë¡œ FILLEDë¡œ ê°ˆ ìˆ˜ ì—†ëŠ” ì´ìœ ëŠ”?"

> "ê²€ì¦ì„ ê±°ì¹˜ì§€ ì•Šì€ ì£¼ë¬¸ì„ ì²´ê²°í•˜ë©´ **ì˜ˆìˆ˜ê¸ˆ ë¶€ì¡± ìƒíƒœì—ì„œ ë§¤ìˆ˜**ê°€ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤. ìƒíƒœ ì „ì´ ê·œì¹™ìœ¼ë¡œ 'ê²€ì¦ â†’ ì²´ê²°' ìˆœì„œë¥¼ ê°•ì œí•˜ì—¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¶ˆë³€ì‹ì„ ë³´ì¥í•©ë‹ˆë‹¤."

### Q5: "switch expressionì˜ ì¥ì ì€?"

> "if-elseì™€ ë‹¬ë¦¬ switch expressionì€ **ëª¨ë“  enum ì¼€ì´ìŠ¤ë¥¼ ì»¤ë²„**í•´ì•¼ ì»´íŒŒì¼ë©ë‹ˆë‹¤. ìƒˆ ìƒíƒœ(ì˜ˆ: PARTIALLY_FILLED)ë¥¼ ì¶”ê°€í•˜ë©´ ëª¨ë“  switch ë¬¸ì—ì„œ ì»´íŒŒì¼ ì—ëŸ¬ê°€ ë°œìƒí•´, IDEê°€ ìˆ˜ì •í•´ì•¼ í•  ìœ„ì¹˜ë¥¼ ì•Œë ¤ì¤ë‹ˆë‹¤."

### Q6: "Self-Validationì˜ ë‹¨ì ì€ ì—†ë‚˜ìš”?"

> "ìƒì„±ìê°€ ë³µì¡í•´ì§€ëŠ” ë‹¨ì ì´ ìˆìŠµë‹ˆë‹¤. í˜„ì¬ëŠ” ifë¬¸ì´ ë§ì•„ `Preconditions` ìœ í‹¸ë¦¬í‹°ë¡œ ë¦¬íŒ©í† ë§ ê³„íšì´ ìˆìŠµë‹ˆë‹¤. ë‹¨, ê²€ì¦ì„ ìƒì„±ìì—ì„œ í•˜ëŠ” **ì›ì¹™ ìì²´ëŠ” ìœ ì§€**í•©ë‹ˆë‹¤. ë„ë©”ì¸ ê°ì²´ê°€ í•­ìƒ ìœ íš¨í•œ ìƒíƒœì„ì„ ë³´ì¥í•˜ëŠ” ê²ƒì´ ë” ì¤‘ìš”í•©ë‹ˆë‹¤."

---

## 9. í•µì‹¬ í‚¤ì›Œë“œ ì •ë¦¬

| í‚¤ì›Œë“œ | ì„¤ëª… | ë©´ì ‘ì—ì„œ ì–´ë–»ê²Œ ë§í• ê¹Œ? |
|--------|------|------------------------|
| **ìƒíƒœ ë¨¸ì‹ ** | ìœ í•œí•œ ìƒíƒœì™€ ì „ì´ ê·œì¹™ | "ì£¼ë¬¸ ìƒëª…ì£¼ê¸°ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ê´€ë¦¬" |
| **ë¶ˆë³€ ê°ì²´** | ìƒíƒœ ë³€ê²½ ì‹œ ìƒˆ ê°ì²´ ë°˜í™˜ | "Thread-safe, Audit Trail ìš©ì´" |
| **Self-Validation** | ìƒì„±ìì—ì„œ ìœ íš¨ì„± ê²€ì¦ | "Fail-Fast, Always Valid Domain Model" |
| **YAGNI** | í•„ìš”í•  ë•Œ ë§Œë“¤ì–´ë¼ | "ê³¼ë„í•œ ì¶”ìƒí™” ë°©ì§€, í˜„ì¬ ìš”êµ¬ì‚¬í•­ì— ì§‘ì¤‘" |
| **Aggregate Root** | ë„ë©”ì¸ ë¶ˆë³€ì‹ ë³´ì¥ ì§„ì…ì  | "Orderê°€ ìƒíƒœ ì „ì´ ê·œì¹™ì„ ìº¡ìŠí™”" |
| **switch expression** | ëª¨ë“  ì¼€ì´ìŠ¤ ê°•ì œ ì»¤ë²„ | "ì»´íŒŒì¼ íƒ€ì„ì— ëˆ„ë½ ë°©ì§€" |

---

## ê´€ë ¨ íŒŒì¼

- [Order.java](file:///Users/mg/Desktop/MG/01-ì´ì§/01-ê°œì¸í”„ë¡œì íŠ¸/kuku/kuku-order-system/src/main/java/com/securities/kuku/order/domain/Order.java)
- [OrderStatus.java](file:///Users/mg/Desktop/MG/01-ì´ì§/01-ê°œì¸í”„ë¡œì íŠ¸/kuku/kuku-order-system/src/main/java/com/securities/kuku/order/domain/OrderStatus.java)
- [OrderTest.java](file:///Users/mg/Desktop/MG/01-ì´ì§/01-ê°œì¸í”„ë¡œì íŠ¸/kuku/kuku-order-system/src/test/java/com/securities/kuku/order/domain/OrderTest.java)
- [ADR-010: ìƒíƒœ ë¨¸ì‹  íŒ¨í„´ ê²°ì •](file:///Users/mg/Desktop/MG/01-ì´ì§/01-ê°œì¸í”„ë¡œì íŠ¸/kuku/docs/adr/010-order-state-machine-pattern.md)
